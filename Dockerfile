FROM mchristopher/canvas-lms-docker:latest-core

RUN set -eux; \
  yarn gulp rev

RUN touch app/stylesheets/_brandable_variables_defaults_autogenerated.scss \
    && touch log/production.log \
    && COMPILE_ASSETS_API_DOCS=0 \
       COMPILE_ASSETS_BRAND_CONFIGS=0 \
       bundle exec rails canvas:compile_assets
